# MsShellcodeDev
The Solution to help Developing &amp; Debugging as C &amp; Deploying in Shellcode.

# Requirement - To Build the Solution
Visual Studio 2026 is the only IDE could be used to compile the solution (as slnx not compatible with older version), hardware & software requirements same as Visual Studio 2026.
For allowing ShellcodeTestLoader to be executed on Windows XP x86/x64 version, v140xp or v141xp toolsets (though deprecated) should be installed in addtion to the C Desktop Development Core Components.

However, for those who prefer older version of MsDev environment, sln could still be converted using "Save as" after opening MsShellcodeDev project using VS2026. After doing so, remember to change configuration to allow compiling. BTW, the projects are compatible to VS 2015 & newer version. (Not trying older version, might work on VS 2012/2013 but lazy to try)

# Requirement - To Build the Shellcode
To execute "Vcxproj to Shellcode Compiler" to convert & compile the vcxproj to shellcode, Windows 7 & Visual Studio 2015 (or higher version OSes/IDEs) are required, so the Software/Hardwre requirements just same as Win 7 & VS 2015. The converted project should be developed using pure C & win32/win64 APIs without class & global variable definitions.

# Usage
Both "ShellcodePrototype" & "ShellcodeSample" are programs could be compiled & executed, the outcome are "run calc.exe & pop MessageBox" and "get system info & pop MessageBox;" "Hash of Func & LibName Calculator" could be used to pick existing dll file & export hash values of DLL file name (including file extension, case-insensitive) & API names (case-sensitive) then save the outcome into assigned csv file path; "ShellcodeTestLoader" is the tool to test extracted binary shellcode files using VirtualAlloc API, just be careful that x86/x64 build of loader could only test corresponding shellcode; "Vcxproj to Shellcode Compiler" is GUI application, since the IDE version & "vcvars32.bat" path could be auto detected, just pick the vcxproj & assign the output name (or not, in this case the name of the converted project will be used) & click on the "Compile" button, the outcome will be there, 2 binary files with no error message or many error messages. The folder "PicProj" will not be deleted for checking the real error messages generated by VC compiler of MsDev, just open terminal, move to the PicProj folder & execute "VcxBuild.bat" to see what's wrong.

# Additional Info
To test the compiled shellcode on windows 2000, be noticed that Visual Studio 2008 was "officially" the last version of MS IDE supporting Windows 2000, please find the Express version of it to install, then migrate "ShellcodeTestLoader" to VS2008 with "careful" modification, and after the successful built, a Windows 2000 compatible Shellcode Test Loader will be there.

# Pros Compared to Other Solutions
1. Auto Converting, Compiling & Extracting: No need to assign string variable as local char array manually, & using dword to save local array variables could help preventing SIMD instruction extension from being used (in the case, array data will be put into data section); no need to calculate api hashes for converter will do it for you.
2. Supporting Getting API by Ordinal: Some undocumented APIs were provided very early (NT 5.0 or even 4.0) but in older version of DLLs, exported by ordinal (Thos ordinals not changed bacause of backward compatibility). If want the shellcode compitible from NT5.0 to NT10.0, try to find those APIs & use them well (Please Google Geoff Chappel for the references he provided)
3. Supporting API forwarding: Using "dumpbin /exports" on DLLs of different versions of Windows, API forwarding could be easily found on many legacy API/DLL pairs. MsShellcodeDev could detect if API forwarding happened in loaded DLL and get the real function address from the forwarded DLL. (FYI, even in kernel32.dll & user32.dll, those frequently used dll, API forwarding was implemented on Windows 11 25H2, & I'm not trying other versions) Using "ShellcodeSample" of "MsShellcodeDev," since the source code included APIs from netapi32.dll that forwarded to other DLLs & APIs from shlwapi.dll that exported using ordinals, Feature 2 & 3 could be tested using one sample.
